% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Software.R
\name{GMC.mcmc}
\alias{GMC.mcmc}
\title{Fit Gaussian mixture copula with the margin adjustment and impute missing data}
\usage{
GMC.mcmc(
  Data,
  nImp = 10,
  Impute = T,
  H = 25,
  k.star = NULL,
  nsamp = 10000,
  burn = floor(0.5 * nsamp),
  hyperparams = NULL,
  seed = NULL
)
}
\arguments{
\item{Data}{Data frame that is the input into the Gaussian Mixture Copula. Categorical and  binary variables should be factors}

\item{nImp}{Number of imputations to Create}

\item{Impute}{logical; Whether or not to create multiple imputations}

\item{H}{Upper bound for the number of components of the mixtures}

\item{k.star}{Dimension of latent factor in mixture}

\item{nsamp}{Number of samples for the MCMC}

\item{burn}{Number of burn-in samples before imputations}

\item{hyperparams}{Optional; Hyperparameter specifications for finite mixuture and RPL
 with default values given by:
\itemize{
\item \code{k.star}: dimension of latent factors, default is \code{floor(.7*p))}
\item \code{plugin.threshold}: threshold for number of unique values in each column for the re-sampling step to be conducted,
default is 350
\item \code{a_alpha}: prior for the stick breaking precision parameter, where the prior is given by \code{gamma(a_alpha,b_alpha)},
default value is 1
\item \code{b_alpha}: prior for the stick breaking precision parameter, where the prior is given by \code{gamma(a_alpha,b_alpha)},
default value is 3
\item \code{nu_mix}: hyper parameter for the component specific prior \eqn{N-IW(0,I_{k.star},nu_mix,kappa_0)} on \eqn{\eta},
default is k.star +2
\item \code{kappa_0}: hyper parameter for the component specific prior \eqn{N-IW(0,I_{k.star},nu_mix,kappa_0)} on \eqn{\eta},
default is .001
\item \code{nu}: hyper parameter for local shrinkage of MGP prior on components of Lambda, default is 3
\item \code{a1}: hyper parameter for global shrinkage of MGP prior on components of Lambda, default is 2
\item \code{a2}: hyper parameter for global shrinkage of MGP prior on components of Lambda, default is 3
\item \code{a.sigma,b.sigma}: hyper parameter for gamma prior on error variance, default value is 1 and 0.3
\item \code{delta}: prior precision parameter for covariance matrix in latent mixture. Increase to discover fewer clusters.
default value is 10
\item \code{D_0}: prior covariance for N-IW. Default is a k.star dimenional identity
}}
}
\value{
A list with the following elements:
\itemize{
\item \code{Imputations} nImp complete data sets
\item \code{Deltas}: List of length H, each containing an \code{(nsamp - burn x k.star x k.star)} array of
 posterior samples of cluster specific covariance matrices
\item \code{mus}: List of length H, each containing an \code{(nsamp-burn x k.star)} array of posterior samples of cluster
specific covariance matrices
\item \code{zs}: Indicies of occupied clusters of dimension \code{(nsamp-burn x H)}. Used for posterior predictive sampling to identify which components of the mixture to use
\item \code{clustering}: Posterior samples of size \code{(nsamp-burn x n)} with discovered clusterings, where each observed is given a membership based on the estimated model
\item \code{Sigmas}: array of dimension \code{(nsamp-burn x p)} containing posterior samples of the error covariance
\item \code{Quantiles}:List of length p, each containing an array of dimension \code{(nsamp-burn x length(support))} with posterior samples of point-wise cumulative probabilities.
\item \code{Support}: List of length p, each containing an array of dimension \code{(nsamp-burn x length(support))} with support of each variable
\item \code{col_mem}: array of length p containing variable names
\item \code{cat_col_names}: array containing names of categorical variables, with the number of repititions indicating eachs' number of levels
\item \code{bin_col_names}: array containing names of binary variables
\item \code{count_col_names}: array containing names of count-valued variables
\item \code{cont_col_names}: array containing names of continous variables
\item \code{dat}: Original data frame, useful for simulating predictive data sets
\item \code{seed}: Seed for replication of results
\item \code{Y_aug}: augmented data set with binary representation of categorical variables.
}
}
\description{
Fit the Gaussian mixture copula to a data set with or without missing data. The user does not have to deal with one-hot-encoding of categorical variables,
which is accomplished by the function. The MCMC non-parametrically estimates marginal distributions through the margin adjustment.
The user is given control over whether or not to impute missing data through the logical \code{Impute} and then how many completed data sets to produce with \code{nImp}.
In addition, the user can specify several hyperparameters under the latent mixture, including the upper bound for the number of clusters in the truncated DP,
the number of unique values of a variable for RPL re-sampling to take place, and prior precision of cluster specific covariance matrices.
}
\details{
The function returns posterior samples of model parameters for posterior predictive checks, as well multiple completed data sets.
}
\examples{
num = 500 #sample size
X1<-rnorm(num) # simulate data set
X2<- rpois(num,5*abs(X1))
X3<- rbernoulli(num,pnorm(-.5+scale(X2)))
#remove values with missingness mechanism R
R = t(sapply(1:num, function(x)rbernoulli(2, p = pnorm(-.5 + .5*abs(X1[x]))))) #change to -.25 for more missing
X<- data.frame(X1,X2,X3)
X_noMis = X
X[which(R[,1] == T),2] = NA
X[which(R[,2] == T),3] = NA
mcmc<-GMC.mcmc(Data = X, nsamp = 1000) #fit model
}
